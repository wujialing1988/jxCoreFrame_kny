<?xml version="1.0" encoding="UTF-8"?>
<SqlMap>
	<sql id="queryPageList">
	SELECT
		V.*, EQUIPMENT_NAME,
		EQUIPMENT_CODE,
		CLASS_CODE,
		CLASS_NAME
	FROM
		(
			SELECT
				T.EQUIPMENT_IDX,
				COUNT(T.EQUIPMENT_IDX) AS REPAIR_COUNT
			FROM
				E_SBJX_REPAIR_PLAN_MONTH T
			WHERE
				T.RECORD_STATUS = 0
			<!-- 代码中需要对年度、月份进行查询条件替换 -->
			AND T.PLAN_YEAR = '$Y'
			AND T.PLAN_MONTH = '$M'
			GROUP BY
				T.EQUIPMENT_IDX
		) V,
		E_EQUIPMENT_PRIMARY_INFO I
	WHERE
		V.EQUIPMENT_IDX = I.IDX
	</sql>
	<sql id="queryItems">
	SELECT
		T.IDX,
		T.PLAN_YEAR,
		T.PLAN_MONTH,
		T.REPAIR_CLASS,
		T.BEGIN_TIME,
		T.END_TIME,
		I.EQUIPMENT_NAME,
		I.EQUIPMENT_CODE,
		T.PLAN_STATUS
	FROM
		E_SBJX_REPAIR_PLAN_MONTH T,
		E_EQUIPMENT_PRIMARY_INFO I
	WHERE
		T.RECORD_STATUS = 0
	AND T.EQUIPMENT_IDX = I.IDX
	</sql>
</SqlMap>